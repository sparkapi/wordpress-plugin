!function(t){var e=function(t){return{title:"General Search",body:[{type:"listbox",name:"style",label:"Style",values:[{text:"Clear",value:"clear"},{text:"White",value:"white"},{text:"Colour 1",value:"colour1"},{text:"Colour 2",value:"colour2"},{text:"Colour 3",value:"colour3"}]}],onsubmit:function(e){t.insertContent('[container style="'+e.data.style+'"]<br /><br />[/container]')}}},o=function(e){var o="Saved Searches",l=[],n=tinyMCE.activeEditor.selection.getContent({format:"text"});if(!0==!!n){var a=wp.shortcode.next("flexmls_idxlinks",n,0);if(!0==!!a)try{var i=a.shortcode.attrs.named;i.hasOwnProperty("title")&&(o=i.title),i.hasOwnProperty("idx_link")&&(l=i.idx_link.split(","))}catch(t){console.log("Error"),console.log(t)}}return{title:"IDX Links",body:[{type:"textbox",name:"title",label:"Title",size:42,value:o},{type:"container",name:"idx_link",label:"IDX Link(s)",onPostRender:function(){var e=this.getEl(),o=e.firstChild,n=(t(o),this);t.post(ajaxurl,{action:"tinymce_get_idx_links"},function(t){if(t.length){for(var o=0;o<n.items().length;o++)n.items()[o].hide();for(var o=0;o<t.length;o++){var a={checked:-1!==l.indexOf(t[o].value),type:"checkbox",text:t[o].text,name:t[o].value};n.append(a)}e.style.overflowY="scroll",n.reflow()}},"json")},items:[{disabled:!0,type:"checkbox",text:"Loading",value:0},{disabled:!0,type:"checkbox",text:"Loading",value:0},{disabled:!0,type:"checkbox",text:"Loading",value:0},{disabled:!0,type:"checkbox",text:"Loading",value:0},{disabled:!0,type:"checkbox",text:"Loading",value:0},{disabled:!0,type:"checkbox",text:"Loading",value:0}]}],onsubmit:function(t){var o={},l=[];for(key in t.data)switch(!0){case"title"===key:o.title=t.data[key];break;default:!0===t.data[key]&&l.push(key)}o.idx_link=l.join(",");var n=wp.shortcode.string({tag:"flexmls_idxlinks",attrs:o,type:"single"});e.insertContent(n)}}},l=function(t){var e="Contact Me",o="",l="Thank you for your request",n="Submit",a=tinyMCE.activeEditor.selection.getContent({format:"text"});if(!0==!!a){var i=wp.shortcode.next("flexmls_leadgen",a,0);if(console.log(i),!0==!!i)try{var r=i.shortcode.attrs.named;r.hasOwnProperty("title")&&(e=r.title),r.hasOwnProperty("blurb")&&(o=r.blurb),r.hasOwnProperty("success")&&(l=r.success),r.hasOwnProperty("buttontext")&&(n=r.buttontext)}catch(t){console.log("Error"),console.log(t)}}return{title:"Lead Generation",body:[{type:"textbox",name:"title",label:"Title",size:42,value:e},{type:"textbox",name:"blurb",label:"Description",multiline:!0,tooltip:"Optional: this text appears below the title",value:o},{type:"textbox",name:"success",label:"Success Message",multiline:!0,tooltip:"Appears after the message is sent successfully",value:l},{type:"textbox",name:"buttontext",label:"Button Text",tooltip:"Customize the text of the submit button",value:n}],onsubmit:function(e){var o={};o.title=JSON.stringify(e.data.title).slice(1,-1),o.blurb=JSON.stringify(e.data.blurb).slice(1,-1),o.success=JSON.stringify(e.data.success).slice(1,-1),o.buttontext=JSON.stringify(e.data.buttontext).slice(1,-1);var l=wp.shortcode.string({tag:"flexmls_leadgen",attrs:o,type:"single"});t.insertContent(l)}}},n=function(t){return{title:"1-Click Location Search",body:[{type:"listbox",name:"style",label:"Style",values:[{text:"Clear",value:"clear"},{text:"White",value:"white"},{text:"Colour 1",value:"colour1"},{text:"Colour 2",value:"colour2"},{text:"Colour 3",value:"colour3"}]}],onsubmit:function(e){t.insertContent('[container style="'+e.data.style+'"]<br /><br />[/container]')}}},a=function(t){return{title:"Market Statistics",body:[{type:"listbox",name:"style",label:"Style",values:[{text:"Clear",value:"clear"},{text:"White",value:"white"},{text:"Colour 1",value:"colour1"},{text:"Colour 2",value:"colour2"},{text:"Colour 3",value:"colour3"}]}],onsubmit:function(e){t.insertContent('[container style="'+e.data.style+'"]<br /><br />[/container]')}}},i=function(t){return{title:"Portal Widget",body:[{type:"listbox",name:"style",label:"Style",values:[{text:"Clear",value:"clear"},{text:"White",value:"white"},{text:"Colour 1",value:"colour1"},{text:"Colour 2",value:"colour2"},{text:"Colour 3",value:"colour3"}]}],onsubmit:function(e){t.insertContent('[container style="'+e.data.style+'"]<br /><br />[/container]')}}},r=function(t){return{title:"IDX Slideshow",body:[{type:"listbox",name:"style",label:"Style",values:[{text:"Clear",value:"clear"},{text:"White",value:"white"},{text:"Colour 1",value:"colour1"},{text:"Colour 2",value:"colour2"},{text:"Colour 3",value:"colour3"}]}],onsubmit:function(e){t.insertContent('[container style="'+e.data.style+'"]<br /><br />[/container]')}}};tinymce.PluginManager.add("flexmlsidx",function(t,s){t.addButton("flexmlsidx_shortcodes",{type:"menubutton",tooltip:"Add a Flexmls widget",title:"Add Flexmls Widget",image:flexmls.pluginurl+"/dist/assets/tinymce_flexmls_pin.png",menu:[{text:"1-Click Location Search",onclick:function(){t.windowManager.open(n(t))}},{text:"General Search",onclick:function(){t.windowManager.open(e(t))}},{text:"IDX Links",onclick:function(){t.windowManager.open(o(t))}},{text:"IDX Slideshow",onclick:function(){t.windowManager.open(r(t))}},{text:"Lead Generation",onclick:function(){t.windowManager.open(l(t))}},{text:"Market Statistics",onclick:function(){t.windowManager.open(a(t))}},{text:"Portal Widget",onclick:function(){t.windowManager.open(i(t))}}]})})}(jQuery);